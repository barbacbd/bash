# This file is autogenerated using the spaceship-provision
# (python built) executable. If you wish to make changes
# it is advised that the changes be made to the template
# or script. All changes to this file will be deleted.

FROM	   archlinux:latest
MAINTAINER Brent Barbachem


####################################################################################
####################################################################################

# Update the repositories
RUN	 pacman -Syy

# Install all of the packages that we will need during the installation
# and some that we may want for editing in the future
RUN yes | pacman -Sy git
RUN yes | pacman -Sy openssl
RUN yes | pacman -Sy openssh
RUN yes | pacman -Sy emacs
RUN yes | pacman -Sy zsh

# Spaceship has several package that it wants to use for various
# reasons including tests and issues online. The following
# is the list of those to install:
RUN yes | pacman -Sy perl


####################################################################################
# The following block creates and configures everything that is required
# for the SSH keys to work.
####################################################################################

# Setup the directory for ssh keys to be contained in.
RUN mkdir -p /root/.ssh

# When running the provision script, the name of the ssh-key generated is
# altered to ssh-key in this directory. This key is copied to here to the image
# and the key is set for github use.
COPY ssh-key /root/.ssh/id_rsa

# All files in .ssh should have these permissions
# NOTE: if using a config the config should also have these properties
RUN chmod -R 600 /root/.ssh

# Set github in the list of known hosts.
# In the event of more required known hosts, you can add them here
RUN ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts

####################################################################################
####################################################################################
# The following directory will be used for FPATH (see the bashrc creation)
RUN mkdir -p /usr/local/share/szh/site-functions

####################################################################################
# add some data to the bashrc file just for future use
####################################################################################
RUN touch .bashrc
RUN echo "# .bashrc" >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "# source global definitions"  >> .bashrc
RUN echo "if [ -f /etc/bashrc ]; then"  >> .bashrc
RUN echo "    . /etc/bashrc"  >> .bashrc
RUN echo "fi"  >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "# Add some aliases that I utilize"  >> .bashrc
RUN echo "alias clean='rm -rf *~'"  >> .bashrc
RUN echo "alias ll='ls -la'"  >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "export fpath=$fpath:/usr/local/share/zsh/site-functions/"  >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "# start the z-shell"  >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "if [ -z /usr/local/share/zsh/site-functions/prompt_spaceship_setup ]; then" >> .bashrc
RUN echo "    ln -s /root/spaceship-prompt/spaceship.zsh /usr/local/share/zsh/site-functions/prompt_spaceship_setup" >> .bashrc
RUN echo "fi"  >> .bashrc
RUN echo ""  >> .bashrc
RUN echo "zsh"  >> .bashrc


####################################################################################
#
# Install the powerline-fonts dependency for spaceship
#
####################################################################################
RUN git clone git@github.com:powerline/fonts.git
#RUN cd fonts
#RUN ./install.sh
# Cleanup what we just did
#RUN cd ..
#RUN rm -rf fonts


####################################################################################
# WAWRNING: AUTO GENERATED - DO NOT EDIT

RUN git clone git@github.com:barbacbd/spaceship-prompt.git

# End auto generation
####################################################################################

# Edit/Create the .zshrc file
RUN touch .zshrc
RUN echo "# .zshrc" >> .zshrc
RUN echo "autoload -U promptinit; promptinit" >> .zshrc
RUN echo "prompt spaceship" >> .zshrc

